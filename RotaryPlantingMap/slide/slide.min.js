function createBannerArea(areaDom,options,isDisplay,dataTime,liColor){dataTime=dataTime||{};liColor=liColor||{};var iframes=document.createDocumentFragment();var imgArea=document.createElement("div");var numberArea=document.createElement("div");var curIndex=0;var changeTimer=null;var setDateTime=dataTime['time']||3000;var setDateSwitch=dataTime['switch']||30;var{liColored,licolor}=liColor;liColored=liColored||"#220DAA";licolor=licolor||"#D3D3D3";var timer=null;initImgs();initNumbers();setStatus();autoChange();function initImgs(){imgArea.setAttribute("style",`width:100%;height:100%;display:flex;overflow:hidden;`);for(let i=0;i<options.length;i++){var obj=options[i];var img=document.createElement("img");img.src=obj.imgUrl;img.setAttribute("style",`min-width:100%;max-width:100%;height:100%;margin-left:0;cursor:pointer`);img.addEventListener('click',function(){location.href=options[i].link;},false);imgArea.appendChild(img);}if(isDisplay){var spanLeft=document.createElement('span');var spanRight=document.createElement('span');spanLeft.setAttribute('style',`width:6%;height:30%;top:33%;position:absolute;background:transparent;`);spanRight.setAttribute('style',`width:6%;height:30%;top:33%;left:94%;position:absolute;background:transparent;`);spanLeft.addEventListener('click',function(){curIndex==0?curIndex=options.length-1:curIndex--;clearInterval(changeTimer);setStatus();autoChange();},false);spanRight.addEventListener('click',function(){curIndex==options.length-1?(curIndex=0):curIndex++;clearInterval(changeTimer);setStatus();autoChange();},false);iframes.appendChild(spanLeft);iframes.appendChild(spanRight);}iframes.appendChild(imgArea);}function initNumbers(){numberArea.setAttribute("style","text-align:center;margin-top:-30px;");for(let i=0;i<options.length;i++){var sp=document.createElement("span");sp.setAttribute("style",`display:inline-block;width:14px;height:14px;background:lightgray;margin:0 7px;border-radius:50%;`);sp.setAttribute("data-i",i);numberArea.appendChild(sp);}iframes.appendChild(numberArea);}numberArea.addEventListener("click",function(event){let i;if((i=event.target.getAttribute("data-i"))){curIndex=i;setStatus();}},false);imgArea.addEventListener("mouseenter",function(event){clearInterval(changeTimer);changeTimer=null;},false);imgArea.addEventListener("mouseleave",function(event){autoChange();},false);function setStatus(){for(let i=0;i<options.length;i++){if(i==curIndex){numberArea.children[i].style.setProperty("background",liColored);}else{numberArea.children[i].style.setProperty("background",licolor);}}var start=parseInt(imgArea.children[0].style["margin-left"]);var targetMarginLeft=curIndex*-100;var dis=targetMarginLeft-start;var duration=500;var speed=dis/duration;if(timer){clearInterval(timer);}timer=setInterval(function(){start+=speed*20;imgArea.children[0].style.setProperty("margin-left",`${start}%`);if(Math.abs(start-targetMarginLeft)<1){imgArea.children[0].style.setProperty("margin-left",`${targetMarginLeft}%`);clearInterval(timer);}},setDateSwitch);}function autoChange(){if(changeTimer)return;changeTimer=setInterval(()=>{curIndex==options.length-1?(curIndex=0):curIndex++;setStatus();},setDateTime);}areaDom.appendChild(iframes);}